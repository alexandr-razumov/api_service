# API Service - –°–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ API

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

API Service - —ç—Ç–æ Spring Boot –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–Ω–µ—à–Ω–∏—Ö API, —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏. –°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Kafka –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Java 17** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Spring Boot 3.2.5** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- **Spring Security** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Spring Data JPA** - —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Apache Kafka** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- **Docker & Docker Compose** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Swagger/OpenAPI** - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **Lombok** - —É–º–µ–Ω—å—à–µ–Ω–∏–µ boilerplate –∫–æ–¥–∞
- **MapStruct** - –º–∞–ø–ø–∏–Ω–≥ –æ–±—ä–µ–∫—Ç–æ–≤
- **Maven** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/main/java/com/example/api_service/
‚îú‚îÄ‚îÄ ApiServiceApplication.java          # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ config/                             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ KafkaConfig.java               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Kafka
‚îÇ   ‚îú‚îÄ‚îÄ OpenApiConfig.java             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Swagger
‚îÇ   ‚îú‚îÄ‚îÄ RetryConfig.java               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è retry
‚îÇ   ‚îî‚îÄ‚îÄ SecurityConfig.java            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ controller/                         # REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ ApiDataController.java         # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä API
‚îú‚îÄ‚îÄ dto/                               # Data Transfer Objects
‚îÇ   ‚îú‚îÄ‚îÄ ApiDataRequest.java            # DTO –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ ApiDataResponse.java           # DTO –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ ErrorResponse.java             # DTO –¥–ª—è –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ exception_handler/                  # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ ApiException.java              # –ë–∞–∑–æ–≤–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ API
‚îÇ   ‚îú‚îÄ‚îÄ BadRequestException.java       # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è 400 –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ GlobalExceptionHandler.java    # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
‚îÇ   ‚îî‚îÄ‚îÄ ResourceNotFoundException.java # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è 404 –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ mapper/                            # –ú–∞–ø–ø–∏–Ω–≥ –æ–±—ä–µ–∫—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ ApiDataMapper.java             # –ú–∞–ø–ø–µ—Ä –¥–ª—è ApiData
‚îú‚îÄ‚îÄ model/                             # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ ApiDataEntity.java             # –°—É—â–Ω–æ—Å—Ç—å –¥–ª—è –ë–î
‚îú‚îÄ‚îÄ repository/                        # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ ApiDataRepository.java         # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è ApiData
‚îî‚îÄ‚îÄ service/                           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
    ‚îî‚îÄ‚îÄ ApiDataService.java            # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Java 17 –∏–ª–∏ –≤—ã—à–µ
- Maven 3.6+
- Docker –∏ Docker Compose
- PostgreSQL (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- Apache Kafka (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### –ó–∞–ø—É—Å–∫ —Å Docker Compose

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone <repository-url>
   cd api_service
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:**
   ```bash
   docker-compose up -d
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤:**
   ```bash
   docker-compose ps
   ```

4. **–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
   - API Service: http://localhost:8080
   - Swagger UI: http://localhost:8080/swagger-ui.html
   - Kafka UI: http://localhost:8081

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTTP Basic Authentication:

- **–†–æ–ª—å USER**: –¥–æ—Å—Ç—É–ø –∫ `/status`
- **–†–æ–ª—å ADMIN**: –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
- `user/user` (—Ä–æ–ª—å USER)
- `admin/admin` (—Ä–æ–ª—å ADMIN)

## üìä Kafka –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –¢–æ–ø–∏–∫–∏

- `api-data-topic` - —É—Å–ø–µ—à–Ω—ã–µ API –≤—ã–∑–æ–≤—ã
- `api-errors-topic` - –æ—à–∏–±–∫–∏ API –≤—ã–∑–æ–≤–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
mvn test

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
mvn test -Dtest=ApiDataServiceTest
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

- **ApiDataService** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- **ApiDataMapper** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞–ø–ø–∏–Ω–≥–∞

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### Swagger UI

–î–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8080/swagger-ui.html

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **Health Check**: `/status`
- **–õ–æ–≥–∏**: `logs/api-service.log`

